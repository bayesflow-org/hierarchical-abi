WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:59: RuntimeWarning: Degrees of freedom <= 0 for slice
  post_vars = samples["estimates"].var(axis=1, ddof=1)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:195: RuntimeWarning: invalid value encountered in divide
  ret = um.true_divide(
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/root_mean_squared_error.py:61: RuntimeWarning: overflow encountered in square
  rmse = np.sqrt(np.mean((samples["estimates"] - samples["targets"][:, None, :]) ** 2, axis=0))
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:176: RuntimeWarning: overflow encountered in multiply
  x = um.multiply(x, x, out=x)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:187: RuntimeWarning: overflow encountered in reduce
  ret = umr_sum(x, axis, dtype, out, keepdims=keepdims, where=where)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:61: RuntimeWarning: overflow encountered in divide
  contraction = np.clip(1 - (post_vars / prior_vars), 0, 1)
Exp: 21 Model: 1 damping_factor_t
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|   blocks.res_blocks.0.dense.weight   |    5376    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    5376    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    2560    |
|     final_projection_linear.bias     |     10     |
+--------------------------------------+------------+
Total Trainable Params: 276746
gaussian_flat1_1score_model_v_variance_preserving_cosine_likelihood_weighting
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
KL: 18.482473123160478, #Steps: 5867.88
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
KL: 32.45922158106602, #Steps: 4945.21
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 112.08812148463392, #Steps: 3005.14
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 148.7694957509676, #Steps: 285.74
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 35.60747551561566, #Steps: 18.85
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 134.92582409850837, #Steps: 82.11
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 140.02387846486906, #Steps: 104.67
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 144.36799740281592, #Steps: 124.89
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 129.40977217173125, #Steps: 147.47
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
Finished after 10000 steps (20000 score evals) at time 0.42223048210144043.
Mean step size: 0.00011555368131193972, min: 1.542238715046551e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
Finished after 10000 steps (20000 score evals) at time 0.40062522888183594.
Mean step size: 0.00011987522117706249, min: 1.534160583105404e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.39979323744773865.
Mean step size: 0.00012004118495351577, min: 1.5458084817510098e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: 36.380492047412424, #Steps: 1736.8947368421052
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 11.376577740547496, #Steps: 36.36
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 11.911118259619512, #Steps: 111.03
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 13.93946411908375, #Steps: 436.26
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 14.05857806706352, #Steps: 758.82
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 14.473357999942504, #Steps: 979.9
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 14.990679925064015, #Steps: 1135.04
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 638.977741461196, #Steps: 87.47
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 498.0331680770684, #Steps: 158.28
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 785.0364240240751, #Steps: 287.61
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 785.893073073991, #Steps: 2228.98
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 792.6504424666032, #Steps: 4056.76
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 753.0018819128871, #Steps: 5433.07
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 791.3973074575324, #Steps: 6460.86
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.06293750554323196.
Mean step size: 9.371563355951394e-05, min: 0.0, max: 0.5
maximum steps reached, increase number of steps.
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
KL: nan, #Steps: 418.96666666666664
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 18896.231411761615, #Steps: 390.27
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 21377.85697506358, #Steps: 1865.44
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
Finished after 10000 steps (20000 score evals) at time 0.8535226583480835.
Mean step size: 1.4677078521636547e-05, min: 1.4662231251350022e-07, max: 0.0003807476896326989
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
Finished after 10000 steps (20000 score evals) at time 0.9952224493026733.
Mean step size: 4.773450452059665e-07, min: 6.902842386580232e-08, max: 1.5414129848068114e-06
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
Finished after 10000 steps (20000 score evals) at time 0.9982258081436157.
Mean step size: 1.7985604237782096e-07, min: 5.031021643731037e-08, max: 4.3617700384857017e-07
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 1
Finished after 10000 steps (20000 score evals) at time 0.9988481998443604.
Mean step size: 1.1775515612294446e-07, min: 4.1875335199392794e-08, max: 2.7781723588304885e-07
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.00019044612417928874.
Mean step size: 0.00018241371388534461, min: 2.0846806947361074e-08, max: 0.1509842872619629
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
Finished after 10000 steps (20000 score evals) at time 0.00033127947244793177.
Mean step size: 0.0001640414443585293, min: 3.241179058477428e-08, max: 0.033483099192380905
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
Finished after 10000 steps (20000 score evals) at time 0.21062633395195007.
Mean step size: 7.978282889581297e-05, min: 3.3128759469036595e-07, max: 0.0008020676323212683
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
