WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
Moving prior to device: cpu
data generated
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|        time_embedding.0.scale        |     1      |
|       time_embedding.1.weight        |     64     |
|        time_embedding.1.bias         |     8      |
|   blocks.res_blocks.0.dense.weight   |   16384    |
|    blocks.res_blocks.0.dense.bias    |    512     |
| blocks.res_blocks.0.projector.weight |   16384    |
|   blocks.res_blocks.1.dense.weight   |   262144   |
|    blocks.res_blocks.1.dense.bias    |    512     |
|   blocks.res_blocks.2.dense.weight   |   262144   |
|    blocks.res_blocks.2.dense.bias    |    512     |
|   blocks.res_blocks.3.dense.weight   |   262144   |
|    blocks.res_blocks.3.dense.bias    |    512     |
|   blocks.res_blocks.4.dense.weight   |   262144   |
|    blocks.res_blocks.4.dense.bias    |    512     |
|   blocks.res_blocks.5.dense.weight   |   262144   |
|    blocks.res_blocks.5.dense.bias    |    512     |
|    final_projection_linear.weight    |    3072    |
|     final_projection_linear.bias     |     6      |
+--------------------------------------+------------+
Total Trainable Params: 1349711
FLItest_global_score_model_v_variance_preserving_cosine_likelihood_weighting
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|        time_embedding.0.scale        |     1      |
|       time_embedding.1.weight        |     64     |
|        time_embedding.1.bias         |     8      |
|   blocks.res_blocks.0.dense.weight   |   17920    |
|    blocks.res_blocks.0.dense.bias    |    512     |
| blocks.res_blocks.0.projector.weight |   17920    |
|   blocks.res_blocks.1.dense.weight   |   262144   |
|    blocks.res_blocks.1.dense.bias    |    512     |
|   blocks.res_blocks.2.dense.weight   |   262144   |
|    blocks.res_blocks.2.dense.bias    |    512     |
|   blocks.res_blocks.3.dense.weight   |   262144   |
|    blocks.res_blocks.3.dense.bias    |    512     |
|   blocks.res_blocks.4.dense.weight   |   262144   |
|    blocks.res_blocks.4.dense.bias    |    512     |
|   blocks.res_blocks.5.dense.weight   |   262144   |
|    blocks.res_blocks.5.dense.bias    |    512     |
|    final_projection_linear.weight    |    1536    |
|     final_projection_linear.bias     |     3      |
+--------------------------------------+------------+
Total Trainable Params: 1351244
FLItest_local_score_model_v_variance_preserving_cosine_likelihood_weighting
+---------------------------------------------------+------------+
|                      Modules                      | Parameters |
+---------------------------------------------------+------------+
|        global_model.time_embedding.0.scale        |     1      |
|        global_model.time_embedding.1.weight       |     64     |
|         global_model.time_embedding.1.bias        |     8      |
|   global_model.blocks.res_blocks.0.dense.weight   |   16384    |
|    global_model.blocks.res_blocks.0.dense.bias    |    512     |
| global_model.blocks.res_blocks.0.projector.weight |   16384    |
|   global_model.blocks.res_blocks.1.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.1.dense.bias    |    512     |
|   global_model.blocks.res_blocks.2.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.2.dense.bias    |    512     |
|   global_model.blocks.res_blocks.3.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.3.dense.bias    |    512     |
|   global_model.blocks.res_blocks.4.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.4.dense.bias    |    512     |
|   global_model.blocks.res_blocks.5.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.5.dense.bias    |    512     |
|    global_model.final_projection_linear.weight    |    3072    |
|     global_model.final_projection_linear.bias     |     6      |
|         local_model.time_embedding.0.scale        |     1      |
|        local_model.time_embedding.1.weight        |     64     |
|         local_model.time_embedding.1.bias         |     8      |
|    local_model.blocks.res_blocks.0.dense.weight   |   17920    |
|     local_model.blocks.res_blocks.0.dense.bias    |    512     |
|  local_model.blocks.res_blocks.0.projector.weight |   17920    |
|    local_model.blocks.res_blocks.1.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.1.dense.bias    |    512     |
|    local_model.blocks.res_blocks.2.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.2.dense.bias    |    512     |
|    local_model.blocks.res_blocks.3.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.3.dense.bias    |    512     |
|    local_model.blocks.res_blocks.4.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.4.dense.bias    |    512     |
|    local_model.blocks.res_blocks.5.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.5.dense.bias    |    512     |
|     local_model.final_projection_linear.weight    |    1536    |
|      local_model.final_projection_linear.bias     |     3      |
+---------------------------------------------------+------------+
Total Trainable Params: 2700955
FLItest_hierarchical_score_model_v_variance_preserving_cosine_likelihood_weighting
Training v-model for 1 epochs with learning rate 0.0005 and likelihood_weighting weighting.
Epoch 1/1, Loss: 27.9574, Valid Loss: 39.4082