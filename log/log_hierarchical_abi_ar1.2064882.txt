
The following have been reloaded with a version change:
  1) linux-rocky8-x86_64/gcc/12.2.0/libxml2/2.10.3-h6soa57 => linux-rocky8-x86_64/gcc/12.2.0/libxml2/2.10.3-w7ngxar
  2) linux-rocky8-x86_64/gcc/12.2.0/xz/5.4.1-cqof5qs => linux-rocky8-x86_64/gcc/12.2.0/xz/5.4.1-c5gajon

WARNING:bayesflow:When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use
with torch.enable_grad():
in contexts where you need gradients (e.g. custom training loops).
/home/jonas/hierarchical-abi/.venv/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:59: RuntimeWarning: Degrees of freedom <= 0 for slice
  post_vars = samples["estimates"].var(axis=1, ddof=1)
/home/jonas/hierarchical-abi/.venv/lib/python3.11/site-packages/numpy/core/_methods.py:195: RuntimeWarning: invalid value encountered in divide
  ret = um.true_divide(
Exp: 29 Model: 9 damping_factor_t
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
Moving prior to device: cpu
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|        time_embedding.0.scale        |     1      |
|       time_embedding.1.weight        |     64     |
|        time_embedding.1.bias         |     8      |
|   blocks.res_blocks.0.dense.weight   |    4096    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    4096    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    768     |
|     final_projection_linear.bias     |     3      |
+--------------------------------------+------------+
Total Trainable Params: 272460
ar1_9_1global_score_model_v_variance_preserving_cosine_likelihood_weighting
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|        time_embedding.0.scale        |     1      |
|       time_embedding.1.weight        |     64     |
|        time_embedding.1.bias         |     8      |
|   blocks.res_blocks.0.dense.weight   |    4352    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    4352    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    256     |
|     final_projection_linear.bias     |     1      |
+--------------------------------------+------------+
Total Trainable Params: 272458
ar1_9_1local_score_model_v_variance_preserving_cosine_likelihood_weighting
+---------------------------------------------------+------------+
|                      Modules                      | Parameters |
+---------------------------------------------------+------------+
|        global_model.time_embedding.0.scale        |     1      |
|        global_model.time_embedding.1.weight       |     64     |
|         global_model.time_embedding.1.bias        |     8      |
|   global_model.blocks.res_blocks.0.dense.weight   |    4096    |
|    global_model.blocks.res_blocks.0.dense.bias    |    256     |
| global_model.blocks.res_blocks.0.projector.weight |    4096    |
|   global_model.blocks.res_blocks.1.dense.weight   |   65536    |
|    global_model.blocks.res_blocks.1.dense.bias    |    256     |
|   global_model.blocks.res_blocks.2.dense.weight   |   65536    |
|    global_model.blocks.res_blocks.2.dense.bias    |    256     |
|   global_model.blocks.res_blocks.3.dense.weight   |   65536    |
|    global_model.blocks.res_blocks.3.dense.bias    |    256     |
|   global_model.blocks.res_blocks.4.dense.weight   |   65536    |
|    global_model.blocks.res_blocks.4.dense.bias    |    256     |
|    global_model.final_projection_linear.weight    |    768     |
|     global_model.final_projection_linear.bias     |     3      |
|         local_model.time_embedding.0.scale        |     1      |
|        local_model.time_embedding.1.weight        |     64     |
|         local_model.time_embedding.1.bias         |     8      |
|    local_model.blocks.res_blocks.0.dense.weight   |    4352    |
|     local_model.blocks.res_blocks.0.dense.bias    |    256     |
|  local_model.blocks.res_blocks.0.projector.weight |    4352    |
|    local_model.blocks.res_blocks.1.dense.weight   |   65536    |
|     local_model.blocks.res_blocks.1.dense.bias    |    256     |
|    local_model.blocks.res_blocks.2.dense.weight   |   65536    |
|     local_model.blocks.res_blocks.2.dense.bias    |    256     |
|    local_model.blocks.res_blocks.3.dense.weight   |   65536    |
|     local_model.blocks.res_blocks.3.dense.bias    |    256     |
|    local_model.blocks.res_blocks.4.dense.weight   |   65536    |
|     local_model.blocks.res_blocks.4.dense.bias    |    256     |
|     local_model.final_projection_linear.weight    |    256     |
|      local_model.final_projection_linear.bias     |     1      |
+---------------------------------------------------+------------+
Total Trainable Params: 544918
ar1_9_1hierarchical_score_model_v_variance_preserving_cosine_likelihood_weighting
Training v-model for 1 epochs with learning rate 0.0005 and likelihood_weighting weighting.
Epoch 1/1, Loss: 26.2665, Valid Loss: 24.7884damping_factor_t
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
global sampling
Moving prior to device: cuda:0
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.05
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
global sampling
Finished after 10000 steps (20000 score evals) at time 0.7027930021286011.
Mean step size: 2.973009588612195e-05, min: 5.324998824107752e-07, max: 0.0003970447869505733
maximum steps reached, not computing any more posterior samples.
local sampling
global shapes (100, 3, 3) (100, 3)
local shapes (100, 3, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.9293414354324341.
Mean step size: 7.068158881299348e-06, min: 2.2472445948551467e-07, max: 0.0001928014971781522
maximum steps reached, not computing any more posterior samples.
local sampling
global shapes (100, 3, 3) (100, 3)
local shapes (100, 3, 16) (100, 16)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
global sampling
Finished after 10000 steps (20000 score evals) at time 0.40425050258636475.
Mean step size: 0.00011914771549154466, min: 3.8330954339471646e-06, max: 0.5
maximum steps reached, not computing any more posterior samples.
local sampling
global shapes (100, 3, 3) (100, 3)
local shapes (100, 3, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 0.05
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
global sampling
Finished after 10000 steps (20000 score evals) at time 0.9458168148994446.
Mean step size: 5.419857545037414e-06, min: 3.6963737670703267e-07, max: 9.704499825602397e-05
maximum steps reached, not computing any more posterior samples.
local sampling
global shapes (100, 6, 3) (100, 3)
local shapes (100, 6, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 4096) (100, 4096)
Length of 'variable_names' should be the same as the number of variables.
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 4096) (100, 4096)
Length of 'variable_names' should be the same as the number of variables.
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 4096) (100, 4096)
Length of 'variable_names' should be the same as the number of variables.
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 0, Damping Factor: 0.05
global sampling
Finished after 10000 steps (20000 score evals) at time 0.03887265920639038.
Mean step size: 9.712260330642496e-05, min: 2.4145140287146205e-06, max: 0.0023349253460764885
maximum steps reached, not computing any more posterior samples.
local sampling
global shapes (100, 2, 3) (100, 3)
local shapes (100, 2, 4096) (100, 4096)
Length of 'variable_names' should be the same as the number of variables.
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.6521419286727905.
Mean step size: 3.4799907966175156e-05, min: 1.8573690567791346e-06, max: 0.0007095638429746032
maximum steps reached, not computing any more posterior samples.
local sampling
global shapes (100, 4, 3) (100, 3)
local shapes (100, 4, 4096) (100, 4096)
Length of 'variable_names' should be the same as the number of variables.
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
global sampling
Finished after 10000 steps (20000 score evals) at time 0.1986616998910904.
Mean step size: 8.018999948338713e-05, min: 2.0982454884688195e-07, max: 0.0005384574178606272
maximum steps reached, not computing any more posterior samples.
local sampling
max steps reached
global shapes (100, 1, 3) (100, 3)
local shapes (100, 1, 4096) (100, 4096)
Length of 'variable_names' should be the same as the number of variables.
smaller damping factor already failed, skipping 1, 0
smaller damping factor already failed, skipping 1, 0
Data Size: 262144, Mini Batch: 26214, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
global sampling
Finished after 10000 steps (20000 score evals) at time 0.057205189019441605.
Mean step size: 0.00012700992945337367, min: 2.1277691075738403e-07, max: 0.12202447652816772
maximum steps reached, not computing any more posterior samples.
local sampling
max steps reached
global shapes (100, 1, 3) (100, 3)
local shapes (100, 1, 262144) (100, 262144)
Length of 'variable_names' should be the same as the number of variables.
smaller damping factor already failed, skipping 1, 0
smaller damping factor already failed, skipping 1, 0
smaller damping factor already failed, skipping 1, 0
smaller damping factor already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller damping factor already failed, skipping 1, 0
smaller damping factor already failed, skipping 1, 0
