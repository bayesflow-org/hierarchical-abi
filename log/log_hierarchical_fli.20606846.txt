WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
/home/jarruda_hpc/hierarchical-abi/problems/fli.py:288: RuntimeWarning: overflow encountered in exp
  tau = np.exp(log_tau)
/home/jarruda_hpc/hierarchical-abi/problems/fli.py:289: RuntimeWarning: overflow encountered in exp
  tau_2 = tau + np.exp(log_delta_tau)
/home/jarruda_hpc/hierarchical-abi/problems/fli.py:288: RuntimeWarning: overflow encountered in exp
  tau = np.exp(log_tau)
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|   blocks.res_blocks.0.dense.weight   |    4096    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    4096    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    1536    |
|     final_projection_linear.bias     |     6      |
+--------------------------------------+------------+
Total Trainable Params: 273158
FLI_1_18_256_5_split_TimeSeriesNetwork_global_score_model_v_variance_preserving_cosine_likelihood_weighting
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|   blocks.res_blocks.0.dense.weight   |    4864    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    4864    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    768     |
|     final_projection_linear.bias     |     3      |
+--------------------------------------+------------+
Total Trainable Params: 273923
FLI_1_18_256_5_split_TimeSeriesNetwork_local_score_model_v_variance_preserving_cosine_likelihood_weighting
+-----------------------------------------------------------+------------+
|                          Modules                          | Parameters |
+-----------------------------------------------------------+------------+
|              summary_net.conv_blocks.0.weight             |     96     |
|               summary_net.conv_blocks.0.bias              |     32     |
|           summary_net.recurrent.skip_conv.weight          |   16384    |
|            summary_net.recurrent.skip_conv.bias           |    128     |
|        summary_net.recurrent.recurrent.weight_ih_l0       |   12288    |
|        summary_net.recurrent.recurrent.weight_hh_l0       |   49152    |
|         summary_net.recurrent.recurrent.bias_ih_l0        |    384     |
|         summary_net.recurrent.recurrent.bias_hh_l0        |    384     |
|    summary_net.recurrent.recurrent.weight_ih_l0_reverse   |   12288    |
|    summary_net.recurrent.recurrent.weight_hh_l0_reverse   |   49152    |
|     summary_net.recurrent.recurrent.bias_ih_l0_reverse    |    384     |
|     summary_net.recurrent.recurrent.bias_hh_l0_reverse    |    384     |
|     summary_net.recurrent.skip_recurrent.weight_ih_l0     |   49152    |
|     summary_net.recurrent.skip_recurrent.weight_hh_l0     |   49152    |
|      summary_net.recurrent.skip_recurrent.bias_ih_l0      |    384     |
|      summary_net.recurrent.skip_recurrent.bias_hh_l0      |    384     |
| summary_net.recurrent.skip_recurrent.weight_ih_l0_reverse |   49152    |
| summary_net.recurrent.skip_recurrent.weight_hh_l0_reverse |   49152    |
|  summary_net.recurrent.skip_recurrent.bias_ih_l0_reverse  |    384     |
|  summary_net.recurrent.skip_recurrent.bias_hh_l0_reverse  |    384     |
|            summary_net.output_projector.weight            |    9216    |
|             summary_net.output_projector.bias             |     18     |
|       global_model.blocks.res_blocks.0.dense.weight       |    4096    |
|        global_model.blocks.res_blocks.0.dense.bias        |    256     |
|     global_model.blocks.res_blocks.0.projector.weight     |    4096    |
|       global_model.blocks.res_blocks.1.dense.weight       |   65536    |
|        global_model.blocks.res_blocks.1.dense.bias        |    256     |
|       global_model.blocks.res_blocks.2.dense.weight       |   65536    |
|        global_model.blocks.res_blocks.2.dense.bias        |    256     |
|       global_model.blocks.res_blocks.3.dense.weight       |   65536    |
|        global_model.blocks.res_blocks.3.dense.bias        |    256     |
|       global_model.blocks.res_blocks.4.dense.weight       |   65536    |
|        global_model.blocks.res_blocks.4.dense.bias        |    256     |
|        global_model.final_projection_linear.weight        |    1536    |
|         global_model.final_projection_linear.bias         |     6      |
|        local_model.blocks.res_blocks.0.dense.weight       |    4864    |
|         local_model.blocks.res_blocks.0.dense.bias        |    256     |
|      local_model.blocks.res_blocks.0.projector.weight     |    4864    |
|        local_model.blocks.res_blocks.1.dense.weight       |   65536    |
|         local_model.blocks.res_blocks.1.dense.bias        |    256     |
|        local_model.blocks.res_blocks.2.dense.weight       |   65536    |
|         local_model.blocks.res_blocks.2.dense.bias        |    256     |
|        local_model.blocks.res_blocks.3.dense.weight       |   65536    |
|         local_model.blocks.res_blocks.3.dense.bias        |    256     |
|        local_model.blocks.res_blocks.4.dense.weight       |   65536    |
|         local_model.blocks.res_blocks.4.dense.bias        |    256     |
|         local_model.final_projection_linear.weight        |    768     |
|          local_model.final_projection_linear.bias         |     3      |
+-----------------------------------------------------------+------------+
Total Trainable Params: 895515
FLI_1_18_256_5_split_TimeSeriesNetwork_hierarchical_score_model_v_variance_preserving_cosine_likelihood_weighting
torch.Size([100, 10, 256, 1]) 1
Global Estimates
mu: -1.1065356 0.17815182
log sigma: 0.006202817 0.12104208
True
mu: -0.9243212938308716
log sigma: 0.1204466000199318
NaNs in theta at time 0.019999999552965164 with step size: tensor(0.0013, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
NaNs in theta at time 1.0 with step size: tensor(0.0100, device='cuda:0')
