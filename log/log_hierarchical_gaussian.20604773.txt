WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:59: RuntimeWarning: Degrees of freedom <= 0 for slice
  post_vars = samples["estimates"].var(axis=1, ddof=1)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:195: RuntimeWarning: invalid value encountered in divide
  ret = um.true_divide(
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/root_mean_squared_error.py:61: RuntimeWarning: overflow encountered in square
  rmse = np.sqrt(np.mean((samples["estimates"] - samples["targets"][:, None, :]) ** 2, axis=0))
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:118: RuntimeWarning: overflow encountered in reduce
  ret = umr_sum(arr, axis, dtype, out, keepdims, where=where)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:176: RuntimeWarning: overflow encountered in multiply
  x = um.multiply(x, x, out=x)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:187: RuntimeWarning: overflow encountered in reduce
  ret = umr_sum(x, axis, dtype, out, keepdims=keepdims, where=where)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:61: RuntimeWarning: overflow encountered in divide
  contraction = np.clip(1 - (post_vars / prior_vars), 0, 1)
Exp: 29 Model: 9 damping_factor_t
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|   blocks.res_blocks.0.dense.weight   |    5376    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    5376    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    2560    |
|     final_projection_linear.bias     |     10     |
+--------------------------------------+------------+
Total Trainable Params: 276746
gaussian_flat9_1score_model_v_variance_preserving_cosine_likelihood_weighting
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
KL: 18.642349476341384, #Steps: 5867.52
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
KL: 31.63862983748468, #Steps: 4996.83
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 97.88107151068712, #Steps: 3019.09
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 152.86375579191983, #Steps: 270.77
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 12.847283191563465, #Steps: 18.8
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 142.3235348860563, #Steps: 86.21
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 138.57749592789284, #Steps: 104.67
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 137.54818593662696, #Steps: 129.5
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 131.61160059142162, #Steps: 139.08
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
Finished after 10000 steps (20000 score evals) at time 0.42223048210144043.
Mean step size: 0.00011555368131994328, min: 1.542238715046551e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
Finished after 10000 steps (20000 score evals) at time 0.4206981956958771.
Mean step size: 0.00011586036236694781, min: 1.5416788301081397e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.39980852603912354.
Mean step size: 0.00012003811317990767, min: 1.5458062989637256e-05, max: 0.5
maximum steps reached, increase number of steps.
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
KL: nan, #Steps: 1957.4545454545455
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 7.809522698315804, #Steps: 28.2
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 9.966009126505048, #Steps: 130.04
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 11.600162162926853, #Steps: 437.55
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 11.580319838737497, #Steps: 759.9
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 12.104507188094722, #Steps: 979.05
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 11.422454292187858, #Steps: 1134.57
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 493.84252896465557, #Steps: 89.55
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 562.2016677149088, #Steps: 114.37
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 673.8695873697881, #Steps: 285.04
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 673.2180405661825, #Steps: 2217.05
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 667.3340916332168, #Steps: 4035.71
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 702.6422665355038, #Steps: 5413.44
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 701.880136612338, #Steps: 6430.59
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.06425633281469345.
Mean step size: 9.358371718237436e-05, min: 0.0, max: 0.5
maximum steps reached, increase number of steps.
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
KL: nan, #Steps: 1556.2954545454545
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 148605.39714552666, #Steps: 1551.2
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 154307.73689591346, #Steps: 3039.36
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
Finished after 10000 steps (20000 score evals) at time 0.849784255027771.
Mean step size: 1.5057760084023345e-05, min: 1.4427671146677312e-07, max: 0.00036949440254829824
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
Finished after 10000 steps (20000 score evals) at time 0.9952324628829956.
Mean step size: 4.764631738544012e-07, min: 7.506395149903256e-08, max: 1.500045755165047e-06
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
Finished after 10000 steps (20000 score evals) at time 0.998221755027771.
Mean step size: 1.8002436147451803e-07, min: 5.3268276900553246e-08, max: 4.548574565887975e-07
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 1
Finished after 10000 steps (20000 score evals) at time 0.9988434910774231.
Mean step size: 1.1803413512647565e-07, min: 4.2664691335403404e-08, max: 2.734935549142392e-07
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.001728726550936699.
Mean step size: 0.00018269974567350271, min: 7.171508542569427e-08, max: 0.09508807212114334
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
Finished after 10000 steps (20000 score evals) at time 0.002185523509979248.
Mean step size: 0.00016454731908548885, min: 9.270181067222438e-08, max: 0.025700176134705544
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
Finished after 10000 steps (20000 score evals) at time 0.20538103580474854.
Mean step size: 8.040267878163965e-05, min: 2.717584379752225e-07, max: 0.0007800918538123369
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
