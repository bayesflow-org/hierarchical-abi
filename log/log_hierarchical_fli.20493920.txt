WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
Mamba not available, using TimeSeriesNetwork instead
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
Moving prior to device: cpu
data generated
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|        time_embedding.0.scale        |     1      |
|       time_embedding.1.weight        |     64     |
|        time_embedding.1.bias         |     8      |
|   blocks.res_blocks.0.dense.weight   |   23552    |
|    blocks.res_blocks.0.dense.bias    |    512     |
| blocks.res_blocks.0.projector.weight |   23552    |
|   blocks.res_blocks.1.dense.weight   |   262144   |
|    blocks.res_blocks.1.dense.bias    |    512     |
|   blocks.res_blocks.2.dense.weight   |   262144   |
|    blocks.res_blocks.2.dense.bias    |    512     |
|   blocks.res_blocks.3.dense.weight   |   262144   |
|    blocks.res_blocks.3.dense.bias    |    512     |
|   blocks.res_blocks.4.dense.weight   |   262144   |
|    blocks.res_blocks.4.dense.bias    |    512     |
|   blocks.res_blocks.5.dense.weight   |   262144   |
|    blocks.res_blocks.5.dense.bias    |    512     |
|    final_projection_linear.weight    |    3072    |
|     final_projection_linear.bias     |     6      |
+--------------------------------------+------------+
Total Trainable Params: 1364047
FLI_GRU_global_score_model_v_variance_preserving_cosine_likelihood_weighting
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|        time_embedding.0.scale        |     1      |
|       time_embedding.1.weight        |     64     |
|        time_embedding.1.bias         |     8      |
|   blocks.res_blocks.0.dense.weight   |   25088    |
|    blocks.res_blocks.0.dense.bias    |    512     |
| blocks.res_blocks.0.projector.weight |   25088    |
|   blocks.res_blocks.1.dense.weight   |   262144   |
|    blocks.res_blocks.1.dense.bias    |    512     |
|   blocks.res_blocks.2.dense.weight   |   262144   |
|    blocks.res_blocks.2.dense.bias    |    512     |
|   blocks.res_blocks.3.dense.weight   |   262144   |
|    blocks.res_blocks.3.dense.bias    |    512     |
|   blocks.res_blocks.4.dense.weight   |   262144   |
|    blocks.res_blocks.4.dense.bias    |    512     |
|   blocks.res_blocks.5.dense.weight   |   262144   |
|    blocks.res_blocks.5.dense.bias    |    512     |
|    final_projection_linear.weight    |    1536    |
|     final_projection_linear.bias     |     3      |
+--------------------------------------+------------+
Total Trainable Params: 1365580
FLI_GRU_local_score_model_v_variance_preserving_cosine_likelihood_weighting
+---------------------------------------------------+------------+
|                      Modules                      | Parameters |
+---------------------------------------------------+------------+
|            summary_net.rnn.weight_ih_l0           |    768     |
|            summary_net.rnn.weight_hh_l0           |   196608   |
|             summary_net.rnn.bias_ih_l0            |    768     |
|             summary_net.rnn.bias_hh_l0            |    768     |
|        summary_net.rnn.weight_ih_l0_reverse       |    768     |
|        summary_net.rnn.weight_hh_l0_reverse       |   196608   |
|         summary_net.rnn.bias_ih_l0_reverse        |    768     |
|         summary_net.rnn.bias_hh_l0_reverse        |    768     |
|            summary_net.rnn.weight_ih_l1           |   393216   |
|            summary_net.rnn.weight_hh_l1           |   196608   |
|             summary_net.rnn.bias_ih_l1            |    768     |
|             summary_net.rnn.bias_hh_l1            |    768     |
|        summary_net.rnn.weight_ih_l1_reverse       |   393216   |
|        summary_net.rnn.weight_hh_l1_reverse       |   196608   |
|         summary_net.rnn.bias_ih_l1_reverse        |    768     |
|         summary_net.rnn.bias_hh_l1_reverse        |    768     |
|            summary_net.projector.weight           |   16384    |
|             summary_net.projector.bias            |     32     |
|        global_model.time_embedding.0.scale        |     1      |
|        global_model.time_embedding.1.weight       |     64     |
|         global_model.time_embedding.1.bias        |     8      |
|   global_model.blocks.res_blocks.0.dense.weight   |   23552    |
|    global_model.blocks.res_blocks.0.dense.bias    |    512     |
| global_model.blocks.res_blocks.0.projector.weight |   23552    |
|   global_model.blocks.res_blocks.1.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.1.dense.bias    |    512     |
|   global_model.blocks.res_blocks.2.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.2.dense.bias    |    512     |
|   global_model.blocks.res_blocks.3.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.3.dense.bias    |    512     |
|   global_model.blocks.res_blocks.4.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.4.dense.bias    |    512     |
|   global_model.blocks.res_blocks.5.dense.weight   |   262144   |
|    global_model.blocks.res_blocks.5.dense.bias    |    512     |
|    global_model.final_projection_linear.weight    |    3072    |
|     global_model.final_projection_linear.bias     |     6      |
|         local_model.time_embedding.0.scale        |     1      |
|        local_model.time_embedding.1.weight        |     64     |
|         local_model.time_embedding.1.bias         |     8      |
|    local_model.blocks.res_blocks.0.dense.weight   |   25088    |
|     local_model.blocks.res_blocks.0.dense.bias    |    512     |
|  local_model.blocks.res_blocks.0.projector.weight |   25088    |
|    local_model.blocks.res_blocks.1.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.1.dense.bias    |    512     |
|    local_model.blocks.res_blocks.2.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.2.dense.bias    |    512     |
|    local_model.blocks.res_blocks.3.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.3.dense.bias    |    512     |
|    local_model.blocks.res_blocks.4.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.4.dense.bias    |    512     |
|    local_model.blocks.res_blocks.5.dense.weight   |   262144   |
|     local_model.blocks.res_blocks.5.dense.bias    |    512     |
|     local_model.final_projection_linear.weight    |    1536    |
|      local_model.final_projection_linear.bias     |     3      |
+---------------------------------------------------+------------+
Total Trainable Params: 4326587
FLI_GRU_hierarchical_score_model_v_variance_preserving_cosine_likelihood_weighting
torch.Size([100, 1, 201]) 1
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:06:48,  1.25it/s]  0%|          | 2/5000 [00:01<57:47,  1.44it/s]    0%|          | 3/5000 [00:02<54:23,  1.53it/s]  0%|          | 4/5000 [00:02<52:45,  1.58it/s]  0%|          | 5/5000 [00:03<51:52,  1.60it/s]  0%|          | 6/5000 [00:03<51:22,  1.62it/s]  0%|          | 7/5000 [00:04<51:01,  1.63it/s]  0%|          | 8/5000 [00:05<50:46,  1.64it/s]  0%|          | 9/5000 [00:05<50:37,  1.64it/s]  0%|          | 10/5000 [00:06<50:32,  1.65it/s]  0%|          | 11/5000 [00:06<50:25,  1.65it/s]  0%|          | 12/5000 [00:07<50:19,  1.65it/s]  0%|          | 13/5000 [00:08<50:16,  1.65it/s]  0%|          | 14/5000 [00:08<50:13,  1.65it/s]  0%|          | 15/5000 [00:09<50:14,  1.65it/s]  0%|          | 16/5000 [00:09<50:13,  1.65it/s]  0%|          | 17/5000 [00:10<50:09,  1.66it/s]  0%|          | 18/5000 [00:11<50:07,  1.66it/s]  0%|          | 19/5000 [00:11<50:06,  1.66it/s]  0%|          | 20/5000 [00:12<50:07,  1.66it/s]  0%|          | 21/5000 [00:12<50:09,  1.65it/s]  0%|          | 22/5000 [00:13<50:08,  1.65it/s]  0%|          | 23/5000 [00:14<50:08,  1.65it/s]  0%|          | 24/5000 [00:14<50:09,  1.65it/s]  0%|          | 25/5000 [00:15<50:08,  1.65it/s]  1%|          | 26/5000 [00:15<50:08,  1.65it/s]  1%|          | 27/5000 [00:16<50:08,  1.65it/s]  1%|          | 28/5000 [00:17<50:09,  1.65it/s]  1%|          | 29/5000 [00:17<50:07,  1.65it/s]  1%|          | 30/5000 [00:18<50:05,  1.65it/s]  1%|          | 31/5000 [00:18<50:07,  1.65it/s]  1%|          | 32/5000 [00:19<50:07,  1.65it/s]  1%|          | 33/5000 [00:20<50:07,  1.65it/s]  1%|          | 34/5000 [00:20<50:04,  1.65it/s]  1%|          | 35/5000 [00:21<50:05,  1.65it/s]  1%|          | 36/5000 [00:21<50:05,  1.65it/s]  1%|          | 37/5000 [00:22<50:03,  1.65it/s]  1%|          | 38/5000 [00:23<50:01,  1.65it/s]  1%|          | 39/5000 [00:23<50:03,  1.65it/s]  1%|          | 39/5000 [00:24<51:43,  1.60it/s]
Finished after 40 steps (80 score evals) at time 0.0.
Mean step size: 0.043478260120457926, min: 0.000137343566166237, max: 0.5
Moving prior to device: cuda:0
Moving prior to device: cpu
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:14,  3.31it/s]  4%|▍         | 2/50 [00:00<00:14,  3.31it/s]  6%|▌         | 3/50 [00:00<00:14,  3.31it/s]  8%|▊         | 4/50 [00:01<00:13,  3.30it/s] 10%|█         | 5/50 [00:01<00:13,  3.30it/s] 12%|█▏        | 6/50 [00:01<00:13,  3.30it/s] 14%|█▍        | 7/50 [00:02<00:13,  3.30it/s] 16%|█▌        | 8/50 [00:02<00:12,  3.30it/s] 18%|█▊        | 9/50 [00:02<00:12,  3.31it/s] 20%|██        | 10/50 [00:03<00:12,  3.31it/s] 22%|██▏       | 11/50 [00:03<00:11,  3.31it/s] 24%|██▍       | 12/50 [00:03<00:11,  3.31it/s] 26%|██▌       | 13/50 [00:03<00:11,  3.31it/s] 28%|██▊       | 14/50 [00:04<00:10,  3.31it/s] 30%|███       | 15/50 [00:04<00:10,  3.30it/s] 32%|███▏      | 16/50 [00:04<00:10,  3.30it/s] 34%|███▍      | 17/50 [00:05<00:09,  3.31it/s] 36%|███▌      | 18/50 [00:05<00:09,  3.31it/s] 38%|███▊      | 19/50 [00:05<00:09,  3.31it/s] 40%|████      | 20/50 [00:06<00:09,  3.31it/s] 42%|████▏     | 21/50 [00:06<00:08,  3.31it/s] 44%|████▍     | 22/50 [00:06<00:08,  3.31it/s] 46%|████▌     | 23/50 [00:06<00:08,  3.30it/s] 48%|████▊     | 24/50 [00:07<00:07,  3.30it/s] 50%|█████     | 25/50 [00:07<00:07,  3.30it/s] 52%|█████▏    | 26/50 [00:07<00:07,  3.31it/s] 54%|█████▍    | 27/50 [00:08<00:06,  3.31it/s] 56%|█████▌    | 28/50 [00:08<00:06,  3.31it/s] 58%|█████▊    | 29/50 [00:08<00:06,  3.31it/s] 60%|██████    | 30/50 [00:09<00:06,  3.30it/s] 62%|██████▏   | 31/50 [00:09<00:05,  3.30it/s] 64%|██████▍   | 32/50 [00:09<00:05,  3.30it/s] 66%|██████▌   | 33/50 [00:09<00:05,  3.30it/s] 68%|██████▊   | 34/50 [00:10<00:04,  3.30it/s] 70%|███████   | 35/50 [00:10<00:04,  3.30it/s] 72%|███████▏  | 36/50 [00:10<00:04,  3.30it/s] 74%|███████▍  | 37/50 [00:11<00:03,  3.30it/s] 76%|███████▌  | 38/50 [00:11<00:03,  3.30it/s] 78%|███████▊  | 39/50 [00:11<00:03,  3.30it/s] 80%|████████  | 40/50 [00:12<00:03,  3.30it/s] 82%|████████▏ | 41/50 [00:12<00:02,  3.30it/s] 84%|████████▍ | 42/50 [00:12<00:02,  3.30it/s] 86%|████████▌ | 43/50 [00:13<00:02,  3.30it/s] 88%|████████▊ | 44/50 [00:13<00:01,  3.30it/s] 90%|█████████ | 45/50 [00:13<00:01,  3.30it/s] 92%|█████████▏| 46/50 [00:13<00:01,  3.30it/s] 94%|█████████▍| 47/50 [00:14<00:00,  3.30it/s] 96%|█████████▌| 48/50 [00:14<00:00,  3.30it/s] 98%|█████████▊| 49/50 [00:14<00:00,  3.30it/s]100%|██████████| 50/50 [00:15<00:00,  3.30it/s]100%|██████████| 50/50 [00:15<00:00,  3.30it/s]
Moving prior to device: cuda:0
Global Estimates
mu: -3.8093 1.7829481
log sigma: -0.7049654 0.25475013
True
mu: -0.374601274728775
log sigma: -0.959984302520752
