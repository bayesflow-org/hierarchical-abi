WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:59: RuntimeWarning: Degrees of freedom <= 0 for slice
  post_vars = samples["estimates"].var(axis=1, ddof=1)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:195: RuntimeWarning: invalid value encountered in divide
  ret = um.true_divide(
Exp: 27 Model: 7 damping_factor_t
Kernel type: variance_preserving, noise schedule: linear
t_min: 0.0005980199202895164, t_max: 3.872983455657959
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|   blocks.res_blocks.0.dense.weight   |    5376    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    5376    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    2560    |
|     final_projection_linear.bias     |     10     |
+--------------------------------------+------------+
Total Trainable Params: 276746
gaussian_flat7_1score_model_v_variance_preserving_linear_likelihood_weighting
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
KL: 169.35220823616862, #Steps: 99.58
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 107.63133145899313, #Steps: 23.65
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 1.6232130997822563, #Steps: 53.22
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1.0
KL: 1.3626588085573619, #Steps: 342.88
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
KL: 29.259556412162222, #Steps: 314.27
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 20.217786056009604, #Steps: 94.29
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 23.67459987480603, #Steps: 399.96
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1.0
KL: 25.832154719474183, #Steps: 1019.29
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
KL: 31.723670439310187, #Steps: 552.71
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 1381.4507451254872, #Steps: 343.11
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 1381.6577871420127, #Steps: 758.64
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 1.0
KL: 1462.8112212847482, #Steps: 5264.04
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
KL: 57657.80923359263, #Steps: 486.51
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 65402.19850066693, #Steps: 1798.94
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 69181.00842301508, #Steps: 4435.65
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 1.0
Finished after 10000 steps (20000 score evals) at time 0.8883668184280396.
Mean step size: 1.1164441711160094e-05, min: 8.575362699048128e-06, max: 6.430778739741072e-05
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
Finished after 10000 steps (20000 score evals) at time 2.2374597392627038e-05.
Mean step size: 0.00016974666663107583, min: 8.127347683739572e-09, max: 0.5
maximum steps reached, increase number of steps.
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
LinAlg error in KL computation: Matrix is not positive definite
KL: 70906988.10274658, #Steps: 8831.142857142857
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
Finished after 10000 steps (20000 score evals) at time 0.00024375709472224116.
Mean step size: 0.0001075239182945982, min: 1.1591992921111682e-09, max: 0.021725764498114586
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
Finished after 10000 steps (20000 score evals) at time 0.4701142907142639.
Mean step size: 5.4672253784037745e-05, min: 7.851492227928247e-06, max: 0.00029355561127886176
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
