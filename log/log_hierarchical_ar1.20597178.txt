WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:59: RuntimeWarning: Degrees of freedom <= 0 for slice
  post_vars = samples["estimates"].var(axis=1, ddof=1)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:195: RuntimeWarning: invalid value encountered in divide
  ret = um.true_divide(
Exp: 17 Model: 7 cosine_shift
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|        time_embedding.0.scale        |     1      |
|       time_embedding.1.weight        |     64     |
|        time_embedding.1.bias         |     8      |
|   blocks.res_blocks.0.dense.weight   |    4096    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    4096    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    768     |
|     final_projection_linear.bias     |     3      |
+--------------------------------------+------------+
Total Trainable Params: 272460
ar1_7_1global_score_model_v_variance_preserving_cosine_likelihood_weighting
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|        time_embedding.0.scale        |     1      |
|       time_embedding.1.weight        |     64     |
|        time_embedding.1.bias         |     8      |
|   blocks.res_blocks.0.dense.weight   |    4352    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    4352    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    256     |
|     final_projection_linear.bias     |     1      |
+--------------------------------------+------------+
Total Trainable Params: 272458
ar1_7_1local_score_model_v_variance_preserving_cosine_likelihood_weighting
+---------------------------------------------------+------------+
|                      Modules                      | Parameters |
+---------------------------------------------------+------------+
|        global_model.time_embedding.0.scale        |     1      |
|        global_model.time_embedding.1.weight       |     64     |
|         global_model.time_embedding.1.bias        |     8      |
|   global_model.blocks.res_blocks.0.dense.weight   |    4096    |
|    global_model.blocks.res_blocks.0.dense.bias    |    256     |
| global_model.blocks.res_blocks.0.projector.weight |    4096    |
|   global_model.blocks.res_blocks.1.dense.weight   |   65536    |
|    global_model.blocks.res_blocks.1.dense.bias    |    256     |
|   global_model.blocks.res_blocks.2.dense.weight   |   65536    |
|    global_model.blocks.res_blocks.2.dense.bias    |    256     |
|   global_model.blocks.res_blocks.3.dense.weight   |   65536    |
|    global_model.blocks.res_blocks.3.dense.bias    |    256     |
|   global_model.blocks.res_blocks.4.dense.weight   |   65536    |
|    global_model.blocks.res_blocks.4.dense.bias    |    256     |
|    global_model.final_projection_linear.weight    |    768     |
|     global_model.final_projection_linear.bias     |     3      |
|         local_model.time_embedding.0.scale        |     1      |
|        local_model.time_embedding.1.weight        |     64     |
|         local_model.time_embedding.1.bias         |     8      |
|    local_model.blocks.res_blocks.0.dense.weight   |    4352    |
|     local_model.blocks.res_blocks.0.dense.bias    |    256     |
|  local_model.blocks.res_blocks.0.projector.weight |    4352    |
|    local_model.blocks.res_blocks.1.dense.weight   |   65536    |
|     local_model.blocks.res_blocks.1.dense.bias    |    256     |
|    local_model.blocks.res_blocks.2.dense.weight   |   65536    |
|     local_model.blocks.res_blocks.2.dense.bias    |    256     |
|    local_model.blocks.res_blocks.3.dense.weight   |   65536    |
|     local_model.blocks.res_blocks.3.dense.bias    |    256     |
|    local_model.blocks.res_blocks.4.dense.weight   |   65536    |
|     local_model.blocks.res_blocks.4.dense.bias    |    256     |
|     local_model.final_projection_linear.weight    |    256     |
|      local_model.final_projection_linear.bias     |     1      |
+---------------------------------------------------+------------+
Total Trainable Params: 544918
ar1_7_1hierarchical_score_model_v_variance_preserving_cosine_likelihood_weighting
Model loaded
cosine_shift
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.5443658232688904.
Mean step size: 4.557676040894448e-05, min: 1.008369281407795e-06, max: 0.0008007255382835865
maximum steps reached, increase number of steps.
local sampling
global shapes (100, 2, 3) (100, 3)
local shapes (100, 2, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: -1, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.11591610312461853.
Mean step size: 8.84348202635729e-05, min: 2.9785292099404614e-06, max: 0.0010105132823809981
maximum steps reached, increase number of steps.
local sampling
global shapes (100, 3, 3) (100, 3)
local shapes (100, 3, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 1, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.951621413230896.
Mean step size: 4.839331164704902e-06, min: 1.34032006826601e-07, max: 8.99021906661801e-05
maximum steps reached, increase number of steps.
local sampling
global shapes (100, 3, 3) (100, 3)
local shapes (100, 3, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 2, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.9260405898094177.
Mean step size: 7.397420816674648e-06, min: 1.5684084075928695e-07, max: 0.00011038105003535748
maximum steps reached, increase number of steps.
local sampling
max steps reached
global shapes (100, 1, 3) (100, 3)
local shapes (100, 1, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 5, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 16) (100, 16)
Data Size: 16, Mini Batch: 1, Conditions: 1, Cosine shift: 10, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 16) (100, 16)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 0, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: -1, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 1, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
smaller mini batch size already failed, skipping 1, 2
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 5, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 256, Mini Batch: 25, Conditions: 1, Cosine shift: 10, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 256) (100, 256)
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 0, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.995796799659729.
Mean step size: 4.21053763367665e-07, min: 5.8350014597863264e-08, max: 1.9867870832968038e-06
maximum steps reached, increase number of steps.
local sampling
max steps reached
global shapes (100, 1, 3) (100, 3)
local shapes (100, 1, 4096) (100, 4096)
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: -1, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.9957917928695679.
Mean step size: 4.2186042788338343e-07, min: 5.799034141773518e-08, max: 1.8045662955046282e-06
maximum steps reached, increase number of steps.
local sampling
max steps reached
global shapes (100, 1, 3) (100, 3)
local shapes (100, 1, 4096) (100, 4096)
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 1, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.9958120584487915.
Mean step size: 4.1971718357521007e-07, min: 6.058564849809045e-08, max: 2.116511723215808e-06
maximum steps reached, increase number of steps.
local sampling
max steps reached
global shapes (100, 1, 3) (100, 3)
local shapes (100, 1, 4096) (100, 4096)
smaller mini batch size already failed, skipping 1, 2
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 5, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.9982336759567261.
Mean step size: 1.7689515870843855e-07, min: 2.52433896008597e-08, max: 6.779170007575885e-07
maximum steps reached, increase number of steps.
local sampling
max steps reached
global shapes (100, 1, 3) (100, 3)
local shapes (100, 1, 4096) (100, 4096)
Data Size: 4096, Mini Batch: 409, Conditions: 1, Cosine shift: 10, Damping Factor: 1
global sampling
local sampling
global shapes (100, 100, 3) (100, 3)
local shapes (100, 100, 4096) (100, 4096)
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, -1
smaller mini batch size already failed, skipping 1, 1
smaller mini batch size already failed, skipping 1, 2
smaller mini batch size already failed, skipping 1, 5
Data Size: 16384, Mini Batch: 1638, Conditions: 1, Cosine shift: 10, Damping Factor: 1
global sampling
Finished after 10000 steps (20000 score evals) at time 0.19048181176185608.
Mean step size: 0.0001494675531042791, min: 1.3512121421754841e-09, max: 0.11920364201068878
maximum steps reached, increase number of steps.
local sampling
max steps reached
global shapes (100, 1, 3) (100, 3)
local shapes (100, 1, 16384) (100, 16384)
