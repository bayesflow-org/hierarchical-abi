WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:59: RuntimeWarning: Degrees of freedom <= 0 for slice
  post_vars = samples["estimates"].var(axis=1, ddof=1)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:195: RuntimeWarning: invalid value encountered in divide
  ret = um.true_divide(
Exp: 28 Model: 8 damping_factor_t
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|   blocks.res_blocks.0.dense.weight   |    5376    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    5376    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    2560    |
|     final_projection_linear.bias     |     10     |
+--------------------------------------+------------+
Total Trainable Params: 276746
gaussian_flat8_1score_model_v_variance_preserving_cosine_likelihood_weighting
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
KL: 18.82464478726307, #Steps: 5867.66
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
KL: 31.803176523668117, #Steps: 4996.67
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 103.9471706389919, #Steps: 3018.89
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 151.79718699904586, #Steps: 258.72
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 73.98480591456878, #Steps: 19.6
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 138.9389133784665, #Steps: 84.27
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 143.73291597020432, #Steps: 113.34
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 142.35758268582344, #Steps: 128.01
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 136.91448493754353, #Steps: 143.19
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
Finished after 10000 steps (20000 score evals) at time 0.42223048210144043.
Mean step size: 0.00011555368132394505, min: 1.542238715046551e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
Finished after 10000 steps (20000 score evals) at time 0.4221118986606598.
Mean step size: 0.00011557741849028388, min: 1.542196150694508e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.3998822867870331.
Mean step size: 0.000120023426939224, min: 1.5458073903573677e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: 39.55912550345536, #Steps: 1886.3333333333333
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 10.455712228324806, #Steps: 34.25
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 8.321510509044144, #Steps: 132.94
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 9.450733732561206, #Steps: 444.55
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 9.809463976984418, #Steps: 767.93
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 9.79002095125883, #Steps: 988.63
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 10.112039446189602, #Steps: 1146.77
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 528.104559995466, #Steps: 57.5
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 479.1479841999402, #Steps: 118.49
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 531.935511761184, #Steps: 297.44
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 554.3483658683117, #Steps: 2244.94
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 544.4063893832207, #Steps: 4074.92
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 579.6725794291463, #Steps: 5450.68
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 587.1956865227195, #Steps: 6481.14
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 264720.6394838288, #Steps: 1773.44
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 283291.6554339605, #Steps: 1926.94
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 243614.47877807973, #Steps: 3381.18
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
Finished after 10000 steps (20000 score evals) at time 0.8482465147972107.
Mean step size: 1.5204240697320674e-05, min: 1.487635614694227e-07, max: 0.00039442305569536984
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
Finished after 10000 steps (20000 score evals) at time 0.9952267408370972.
Mean step size: 4.769058648137954e-07, min: 7.265636270403775e-08, max: 1.4706530464536627e-06
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
Finished after 10000 steps (20000 score evals) at time 0.9982225894927979.
Mean step size: 1.7998920278519544e-07, min: 5.115210299777573e-08, max: 4.4671165255749656e-07
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 1
Finished after 10000 steps (20000 score evals) at time 0.9988440275192261.
Mean step size: 1.1796918867591098e-07, min: 4.147988263980551e-08, max: 2.593741896816937e-07
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.002303384942933917.
Mean step size: 0.00018126759465966565, min: 1.163391232239519e-07, max: 0.2860824465751648
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
Finished after 10000 steps (20000 score evals) at time 0.0024250668939203024.
Mean step size: 0.00016273648791958448, min: 1.0848993525769401e-07, max: 0.02819892391562462
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
Finished after 10000 steps (20000 score evals) at time 0.21706196665763855.
Mean step size: 7.918834636232873e-05, min: 3.0475243306682387e-07, max: 0.0007827492081560194
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
