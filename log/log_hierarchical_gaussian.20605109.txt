WARNING:bayesflow:
When using torch backend, we need to disable autograd by default to avoid excessive memory usage. Use

with torch.enable_grad():
    ...

in contexts where you need gradients (e.g. custom training loops).
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:59: RuntimeWarning: Degrees of freedom <= 0 for slice
  post_vars = samples["estimates"].var(axis=1, ddof=1)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:195: RuntimeWarning: invalid value encountered in divide
  ret = um.true_divide(
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/root_mean_squared_error.py:61: RuntimeWarning: overflow encountered in square
  rmse = np.sqrt(np.mean((samples["estimates"] - samples["targets"][:, None, :]) ** 2, axis=0))
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:176: RuntimeWarning: overflow encountered in multiply
  x = um.multiply(x, x, out=x)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/numpy/core/_methods.py:187: RuntimeWarning: overflow encountered in reduce
  ret = umr_sum(x, axis, dtype, out, keepdims=keepdims, where=where)
/home/jarruda_hpc/.conda/envs/habi/lib/python3.11/site-packages/bayesflow/diagnostics/metrics/posterior_contraction.py:61: RuntimeWarning: overflow encountered in divide
  contraction = np.clip(1 - (post_vars / prior_vars), 0, 1)
Exp: 26 Model: 6 damping_factor_t
Kernel type: variance_preserving, noise schedule: cosine
t_min: 0.00035210439818911254, t_max: 0.999647855758667
alpha, sigma: (tensor(1.0000), tensor(0.0006)) (tensor(0.0006), tensor(1.0000))
+--------------------------------------+------------+
|               Modules                | Parameters |
+--------------------------------------+------------+
|   blocks.res_blocks.0.dense.weight   |    5376    |
|    blocks.res_blocks.0.dense.bias    |    256     |
| blocks.res_blocks.0.projector.weight |    5376    |
|   blocks.res_blocks.1.dense.weight   |   65536    |
|    blocks.res_blocks.1.dense.bias    |    256     |
|   blocks.res_blocks.2.dense.weight   |   65536    |
|    blocks.res_blocks.2.dense.bias    |    256     |
|   blocks.res_blocks.3.dense.weight   |   65536    |
|    blocks.res_blocks.3.dense.bias    |    256     |
|   blocks.res_blocks.4.dense.weight   |   65536    |
|    blocks.res_blocks.4.dense.bias    |    256     |
|    final_projection_linear.weight    |    2560    |
|     final_projection_linear.bias     |     10     |
+--------------------------------------+------------+
Total Trainable Params: 276746
gaussian_flat6_1score_model_v_variance_preserving_cosine_likelihood_weighting
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
KL: 18.694401748067136, #Steps: 5867.39
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
KL: 31.209536992116938, #Steps: 4996.91
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 132.83681662879016, #Steps: 3021.59
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 145.91699926843134, #Steps: 259.94
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 60.2773848782621, #Steps: 19.26
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 142.12037118948348, #Steps: 78.83
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 140.86056595593064, #Steps: 104.56
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 139.2315869302471, #Steps: 142.43
Data Size: 10, Mini Batch: 1, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 127.23821165071085, #Steps: 154.83
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1e-05
Finished after 10000 steps (20000 score evals) at time 0.42223048210144043.
Mean step size: 0.00011555368143890519, min: 1.542238715046551e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.0001
Finished after 10000 steps (20000 score evals) at time 0.4144859313964844.
Mean step size: 0.00011710268931201427, min: 1.539386903459672e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.3999905586242676.
Mean step size: 0.00012000175127832336, min: 1.545805571367964e-05, max: 0.5
maximum steps reached, increase number of steps.
KL: 35.413744180712705, #Steps: 1631.0714285714287
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 7.825680610920556, #Steps: 33.8
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 9.050789475235424, #Steps: 126.38
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 10.341314155098386, #Steps: 437.61
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 10.717872825718706, #Steps: 760.99
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 10.557702172522129, #Steps: 981.82
Data Size: 100, Mini Batch: 10, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 10.930675926228153, #Steps: 1138.64
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
KL: 437.91368756686364, #Steps: 125.11
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 296.6959796273891, #Steps: 226.9
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 600.8621514885592, #Steps: 330.98
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
KL: 651.2715697570154, #Steps: 2278.43
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
KL: 677.9775767798907, #Steps: 4117.96
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
KL: 668.8303605823249, #Steps: 5489.36
Data Size: 1000, Mini Batch: 100, Conditions: 1, Cosine shift: 0, Damping Factor: 1
KL: 659.2609330049556, #Steps: 6509.97
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.0630151629447937.
Mean step size: 9.372662829562374e-05, min: 0.0, max: 0.21049310266971588
maximum steps reached, increase number of steps.
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
LinAlg error in KL computation: Matrix is not positive definite
KL computation failed even with regularization
KL: nan, #Steps: 6697.5
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
KL: 396159.3474506512, #Steps: 3431.16
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
KL: 516538.1404639823, #Steps: 4988.76
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.5
Finished after 10000 steps (20000 score evals) at time 0.8411319851875305.
Mean step size: 1.5920428218455483e-05, min: 1.352648411057089e-07, max: 0.00038712332025170326
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.75
Finished after 10000 steps (20000 score evals) at time 0.9952315092086792.
Mean step size: 4.764906620714338e-07, min: 7.237841259666311e-08, max: 1.5316390999942087e-06
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.9
Finished after 10000 steps (20000 score evals) at time 0.9982229471206665.
Mean step size: 1.7999261796891437e-07, min: 5.1109964260831475e-08, max: 4.5152492589295434e-07
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 10000, Mini Batch: 1000, Conditions: 1, Cosine shift: 0, Damping Factor: 1
Finished after 10000 steps (20000 score evals) at time 0.9988462328910828.
Mean step size: 1.1780205641513384e-07, min: 4.11159071234124e-08, max: 2.6221258053737984e-07
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.001
Finished after 10000 steps (20000 score evals) at time 0.00562863377854228.
Mean step size: 0.000181753123135118, min: 2.167133317243497e-07, max: 0.1948256939649582
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.01
Finished after 10000 steps (20000 score evals) at time 0.006606484763324261.
Mean step size: 0.00016317239178375242, min: 2.475747749031143e-07, max: 0.026687016710639
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
Data Size: 100000, Mini Batch: 10000, Conditions: 1, Cosine shift: 0, Damping Factor: 0.1
Finished after 10000 steps (20000 score evals) at time 0.20817109942436218.
Mean step size: 8.000688175625344e-05, min: 3.2276062711389386e-07, max: 0.0007656709640286863
maximum steps reached, increase number of steps.
KL: nan, #Steps: 10000.0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
smaller mini batch size already failed, skipping 1, 0
